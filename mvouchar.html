{% extends 'cheque/base.html' %}
{% block content %}
<head>
    <meta charset="UTF-8">
    <title>Cheque Entry Form</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
   
    <script>
        var i = parseInt(0);
        var sum = parseInt(0);
        $(document).ready(function () {
			var i = parseInt(0);
            $("#btnAdd").click(function () {
                var name1 = $("#billNo").val();
                var name2 = $("#billDetails").val();
                var name3 = $("#amnt").val();
                sum += parseInt(name3);
                var markup = "<tr id='" + i + "'><td>" + name1 + "</td><td>" + name2 + "</td><td>" + name3 + "</td><td><button id='Button" + i + "' type='button' value='Edit' onclick='Edit(" + i + ")'>Edit</button> <button id='Button244' type='button' value='Delete' onclick='deleteRow(" + i + ")'>Delete</button></td></tr>";
                i++;
                $("table tbody").append(markup);
                $('table tbody:last-child').append('<tr>...</tr><tr>...</tr>');

                $("#total").text(sum);
            });
            $("#Button").click(function () {
                $("#'" + i + "'").remove(rowid);
            });
			$(".btnEdit").bind("click", Edit);
			$("#btnjson").click(function () {
			var array1 = [];
					$("tbody tr").each(function () {
                        var firstTableData = {};
                        firstTableData.BillNo = $(this).find('td').eq(0).text();
                        firstTableData.BillDetails = $(this).find('td').eq(1).text();
                        firstTableData.Amount = $(this).find('td').eq(2).text();
                        array1.push(firstTableData);
                    //}
                }); 
				alert(JSON.stringify(array1));
				 $.ajax({
				type: "POST",
				url: "/jsondata/",
				dataType: 'json',
				data: {
				MyData: JSON.stringify(array1),
				
				
				},
					   
				success: function(msg){
                alert(msg);
            }
        });
        return false;
    } );
			});
			
		
			//$.ajax({
        //url: '/jsondata/',
		
        //data: {
          //'BillNo': billNo,
          //'BillDetails': billDetails,
		  //'Amount': amnt,
       // //},
        //dataType: 'json',
        //success: function (data) {
         // if (data.is_taken) {
          //  alert("Message.");
        //  }
       // }
      //});	});
			//var array1 = [];
					//$("tbody tr").each(function () {
							
                    //var amount = $(this).find('td').eq(2).text().trim();
                    //if (!isNaN(amount) && parseFloat(amount) > 0) {
                    //    var firstTableData = {};
                     //   firstTableData.BillNo = $(this).find('td').eq(0).text().trim();
                     //   firstTableData.BillDetails = $(this).find('td').eq(1).text().trim();
                    //    firstTableData.Amount = $(this).find('td').eq(2).text().trim();
                     //   array1.push(firstTableData);
                    //}
                //});
				//{
				//jQuery.get( "http://127.0.0.1:8000/jsondata/", { data: array1 } );
				 
    			//alert(JSON.stringify(array1));
				//};

				//e.preventDefault();
			//});
        //});
        function deleteRow(rowid) {
		 var cellText = 0;
            if (confirm("Do you want to delete: " + name)) {
                var aa = $("#" + rowid).find("td:eq(2)").text();
                sum -= parseInt(aa);
                $("#" + rowid).remove();
                $("#total").text(sum);

            }
			   $('table tbody tr').each(function () {
                cellText += parseInt($(this).find("td:eq(2)").text());
            });
            $("#total").text("");
            $("#total").text(cellText);
            sum = cellText;
        }
        function Edit(rowid) {
            
            var bil = $("#" + rowid).find("td:eq(0)").text();
            var acc = $("#" + rowid).find("td:eq(1)").text();
            var amt = $("#" + rowid).find("td:eq(2)").text();
            $("#" + rowid).find("td:eq(0)").html("<input type='text' id='txtName1' value='" + bil + "'/>");
            $("#" + rowid).find("td:eq(1)").html("<input type='text' id='txtName2' value='" + acc + "'/>");
            $("#" + rowid).find("td:eq(2)").html("<input type='text' id='txtName3' value='" + amt + "'/>");
            $("#Button" + rowid).val("Save");
            $("#Button" + rowid).attr("onclick", "Save(" + rowid + ")");
        };
        function Save(rowid) {
		 var cellText = 0;
            $("#" + rowid).find("td:eq(0)").text($("#txtName1").val());
            $("#" + rowid).find("td:eq(1)").text($("#txtName2").val());
            $("#" + rowid).find("td:eq(2)").text($("#txtName3").val());
			$("#Button" + rowid).val("Edit");
            $("#Button" + rowid).attr("onclick", "Edit(" + rowid + ")");
		$('table tbody tr').each(function () {
                cellText += parseInt($(this).find("td:eq(2)").text());
            });
            $("#total").text("");
            $("#total").text(cellText);
            sum = cellText;
        };

    $("#btnAdd").click(function(){
         tempResult.val(tempResult.val()+ total);
		 $("#totalAmount").val(total);
		$("#amount_string").val(convertNumberToWords($("#totalAmount").val()));    
    });    
    </script>
   
<script>
function printDiv(divName) {
 //alert('s');
 var printContents = '<div id="print-content"><form><table width="100%"  height="100" ><tbody >';
  var inputs, index;
inputs = document.querySelectorAll('input,select');
printContents+='<div style="width:765px; float:left; height:72px;">';
printContents+='<div style="width:206px; height:20px; float:right; margin-right:0.5px; margin-left:0.5px; font-family:Arial, Helvetica, sans-serif; letter-spacing:12px; line-height:18.897637795px; font-size:15px;">';
printContents+=inputs[10].value+'</div><br><br>';
printContents+='<div style="width:201px; height:9px; float:right; margin-right:0.5px; font-family:Arial, Helvetica, sans-serif; letter-spacing:10px; line-height:19px; font-size:15px;">date</div></div>';
printContents+='<div style="float:left; height:352px; width:768px;"  id="printdiv"><br>';
printContents+='<div style="width:width:765px; height:27px; float:left;">';
printContents+='<div style="width:666px;height:27px; line-height:27px; margin-right:0.5px; margin-left:56px; font-family:Arial, Helvetica, sans-serif; font-size:15px; color:#000;">PAY&emsp;';
printContents+=inputs[4].value+'</div></div><br><br>';
printContents+='<div style="width:width:765px; height:27px; float:left;">';
printContents+='<div style="width:666px;height:27px; float:left; margin-right:0.5px; line-height:27px;  margin-left:56px; font-family:Arial, Helvetica, sans-serif; font-size:15px; color:#000;">RUPEES&emsp;';
printContents+= inputs[7].value;
printContents+='</div></div>';
printContents+='<div style="width:width:768px; height:27px; float:right;">';
printContents+='<div style="width:31px; height:27px; float:left; align:center; vertical-align:middle; line-height:27px; margin-left:56px; font-family:Arial, Helvetica, sans-serif; font-size:15px; color:#000;"><b>&nbsp;â‚¹&nbsp;</b></div>';
printContents+='<div style="width:254px; height:27px; letter-spacing:2px; margin-right:0.5px; float:left; align:left; vertical-align:middle; line-height:26.456692913px; margin-right:45px; font-family:Arial, Helvetica, sans-serif; font-size:15px; color:#000;">';
printContents+= '&nbsp;'+inputs[6].value+'</div></div><br><br><br><br><br><br>';
printContents+='<div style="width:768px; height:27px; float:left;">';
printContents+='<div style="width:61px; height:27px; float:left; vertical-align:middle; align:center; line-height:27px; margin-left:56px; font-family:Arial, Helvetica, sans-serif; font-size:15px; color:#000;">&nbsp;A/c No.&nbsp;</div>';
printContents+='<div style="width:300px; height:27px; vertical-align:middle; float:left; line-height:27px; font-family:Arial, Helvetica, sans-serif; font-size:15px; color:#000; letter-spacing: 2px;">';
printContents+= '&nbsp;'+inputs[8].value+'</div></div>';
printContents+='<br><br><br><br><br><br>';
printContents+='<div style="width:768px; height:26.456692913px; float:right;">';
printContents+='<div style="width:144px; height:27px; float:right; line-height:27px; margin-right:2.5px; margin-left:71px; font-size:15px;">';
printContents+='Please sign above'
printContents+='</div></div>';
printContents +='</tbody></table>';
 w=window.open();
 w.document.write(printContents);
 w.print();
 w.close();
}
</script>
<script>
$(document).ready(function(){
    var total=0;
    var temp="";
    var tempResult=$("#tempResult");
		$("#btn1").click(function(){
		
        var billNo=$("#billNo").val();
        var billDetails=$("#billDetails").val();
        var amnt=$("#amnt").val();

        tempResult.val(tempResult.val()+ billNo + "-" +billDetails+ "-" +amnt+"\n");
        total+=parseFloat(amnt);
    });

    $("#btn2").click(function(){
	var cellText=0;
	$('table tbody tr').each(function () {
                cellText += parseInt($(this).find("td:eq(2)").text());
            });
            $("#total").text("");
            $("#total").text(cellText);
         //tempResult.val(tempResult.val()+ total);
		 $("#totalAmount").val(cellText);
		$("#amount_string").val(convertNumberToWords($("#totalAmount").val()));    
    });
});
</script>
<script>
function convertNumberToWords(amount) {
    var words = new Array();
    words[0] = '';
    words[1] = 'One';
    words[2] = 'Two';
    words[3] = 'Three';
    words[4] = 'Four';
    words[5] = 'Five';
    words[6] = 'Six';
    words[7] = 'Seven';
    words[8] = 'Eight';
    words[9] = 'Nine';
    words[10] = 'Ten';
    words[11] = 'Eleven';
    words[12] = 'Twelve';
    words[13] = 'Thirteen';
    words[14] = 'Fourteen';
    words[15] = 'Fifteen';
    words[16] = 'Sixteen';
    words[17] = 'Seventeen';
    words[18] = 'Eighteen';
    words[19] = 'Nineteen';
    words[20] = 'Twenty';
    words[30] = 'Thirty';
    words[40] = 'Forty';
    words[50] = 'Fifty';
    words[60] = 'Sixty';
    words[70] = 'Seventy';
    words[80] = 'Eighty';
    words[90] = 'Ninety';
    amount = amount.toString();
    var atemp = amount.split(".");
    var number = atemp[0].split(",").join("");
    var n_length = number.length;
    var words_string = "";
    if (n_length <= 9) {
        var n_array = new Array(0, 0, 0, 0, 0, 0, 0, 0, 0);
        var received_n_array = new Array();
        for (var i = 0; i < n_length; i++) {
            received_n_array[i] = number.substr(i, 1);
        }
        for (var i = 9 - n_length, j = 0; i < 9; i++, j++) {
            n_array[i] = received_n_array[j];
        }
        for (var i = 0, j = 1; i < 9; i++, j++) {
            if (i == 0 || i == 2 || i == 4 || i == 7) {
                if (n_array[i] == 1) {
                    n_array[j] = 10 + parseInt(n_array[j]);
                    n_array[i] = 0;
                }
            }
        }
        value = "";
        for (var i = 0; i < 9; i++) {
            if (i == 0 || i == 2 || i == 4 || i == 7) {
                value = n_array[i] * 10;
            } else {
                value = n_array[i];
            }
            if (value != 0) {
                words_string += words[value] + " ";
            }
            if ((i == 1 && value != 0) || (i == 0 && value != 0 && n_array[i + 1] == 0)) {
                words_string += "Crores ";
            }
            if ((i == 3 && value != 0) || (i == 2 && value != 0 && n_array[i + 1] == 0)) {
                words_string += "Lakhs ";
            }
            if ((i == 5 && value != 0) || (i == 4 && value != 0 && n_array[i + 1] == 0)) {
                words_string += "Thousand ";
            }
            if (i == 6 && value != 0 && (n_array[i + 1] != 0 && n_array[i + 2] != 0)) {
                words_string += "Hundred and ";
            } else if (i == 6 && value != 0) {
                words_string += "Hundred ";
            }
        }
        words_string = words_string.split("  ").join(" ");
    }
    return words_string + 'Only';
}
</script>
<style>
input[type=text], select, textarea {
  font-size:100%;
  width: 40%; /* Full width */
  padding: 10px; /* Some padding */
  border: 1px solid #ccc; /* Gray border */
  border-radius: 4px; /* Rounded borders */
  box-sizing: border-box; /* Make sure that padding and width stays in place */
  margin-top: 10px; /* Add a top margin */
  margin-bottom: 20px; /* Bottom margin */
  resize: vertical /* Allow the user to vertically resize the textarea (not horizontally) */
  word-break: break-all;
}
.button {
  background-color: black;
  color: white;
  padding: 12px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  margin-left: 15px;
}
/* When moving the mouse over the submit button, add a darker green color */
.button:hover {
  color: black;
  background-color: gray;
}

/* Add a background color and some padding around the form */
.container {
  border-radius: 1px;
  background-color: #f0f5f5;
  padding: 5px 8px;
  width: 99%;
  height: 100%;
  align: center;
}

table {
    width:50%;
	align: center;
}
table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
}
th, td {
    padding: 12px;
    text-align: left;
}
table#t01 tr:nth-child(even) {
    background-color: #eee;

}
table#t01 tr:nth-child(odd) {
   background-color: #fff;
}
table#t01 th {
    background-color: grey;
    color: white;
}
</style>
<body>
<div class="container">
	<h2 align="center">Cheque Entry Form</h2>
		<div id="print-content">
			<form action="/cheque/mvouchar/" method = "post" name="mvouchar" id="contact-form">
			{% csrf_token %}
			<section align="center"><b>
			{% if messages %}
				{% for message in messages %}
					<p{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</p>
				{% endfor %}
			{% endif %}
			<b><b>
			
			Bill No: <input type="text" name="billno" id="billNo" autocomplete="off">
			Amount: <input type="text" name="amount2" id="amnt" pattern="[0-9]+" title="please enter amount" autocomplete="off">
			<br>
			Bill Details: <input type="text" id="billDetails" name="billdetails" style="margin: 1px 0px 20px; width: 1000px; height: 42px;" autocomplete="off">
			<button type="button" id="btnAdd" class="button" value="Add">Add</button> <button type="button" id="btn2" class="button" value="Complete all entries">Complete All entries</button>
			 <br><br>
			<table name="txt" id="tempResult" align="center">
			  <thead>
			   <tr>
				 <th>Bill No</th>
				 <th>Bill Details</th>
				 <th>Amount</th>
				 <th>Action</th>
			   </tr>
			  </thead>
			  <tbody>
			  </tbody>
			  <tfoot>
				<tr>
				  <td></td>
				  <td></td>
				  <td></td>
				  <td>Total : <span id="total"></span></td>
				</tr>
			   </tfoot>
			 </table>
			 
			<br>
			To Pay: <select name="pay" id="To Pay">
			<option value="Chief">Cheif Cell Centre</option>
			<option value="Chief RPC">Cheif RPC</option></select>
			Cheque No: <input type="text" name="chequeno" id="Cheque No" autocomplete="off">
			
			<br>
			Amount: <input type="text" name="amount1" id="totalAmount" pattern="[0-9]+" placeholder="Amount" onkeyup="amount_string.value=convertNumberToWords(this.value)" autocomplete="off" style="margin: 1px 0px 20px; width: 570px; height: 42px;" >
			Amount in Words: <input type="text" name="amount_string" id="amount_string" autocomplete="off">
			<br>
			A/c No: <input type="text" name="accountno" id="Account No" pattern="[A-Za-z0-9]{9,18}" title="Please Enter a Valid Account" autocomplete="off" style="margin: 1px 0px 20px; width: 350px; height: 42px;" >
			Vouchar No: <input type="text" name="voucharno" id="Voucher No"  autocomplete="off" style="margin: 1px 0px 20px; width: 350px; height: 42px;">
			Cheque Date: <input type="text" placeholder="ddmmyyyy" name="chequedate" id="Cheque Date" autocomplete="off"  style="margin: 1px 0px 20px; width: 350px; height: 42px;">
			
			<button  id="btnjson1" type="submit" value="ok" class="button" onclick="printDiv('print-table')">Ok</button>
	</section>		
</form>
</div>
</div>
</body>
</html>
{% endblock %}